import{a as g,r as a,j as e,L as j,i as y}from"./index-BhxEaC_k.js";import{Q as I,B as d}from"./ReactToastify-BodD9Uj_.js";const x="_wishlist_1h6yj_1",_="_wishlistContainer_1h6yj_16",v="_wishlistItem_1h6yj_24",C="_removeButton_1h6yj_77",i={wishlist:x,wishlistContainer:_,wishlistItem:v,removeButton:C};function E(){const u=g(),[n,c]=a.useState([]),[m,l]=a.useState(!1),p=async()=>{try{const t=localStorage.getItem("authToken");if(t){l(!0);const s=await fetch("https://shopplus-ecom.onrender.com/wishlist",{headers:{Authorization:`Bearer ${t}`}});if(!s.ok){console.error("Failed to fetch wishlist:",s.status,s.statusText);return}const r=await s.json();c(r.wishlist||[])}else l(!1),console.log("User is not authenticated.")}catch(t){console.error("Error fetching wishlist:",t.message)}};a.useEffect(()=>{p()},[]);const w=async t=>{const s=localStorage.getItem("authToken"),r=localStorage.getItem("userId");if(!s){alert("Please log in to add items to the cart.");return}u(y(1));try{const o=await fetch("https://shopplus-ecom.onrender.com/cart",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({userId:r,productId:t,quantity:1})});if(!o.ok){console.error("Failed to add to cart:",o.status,o.statusText),alert("Failed to add item to cart.");return}const h=await o.json();d.success("Successfully added the Product to the cart!",{position:"top-center",autoClose:2e3})}catch(o){console.error("Error adding to cart:",o.message),alert("Error adding item to cart.")}},f=async t=>{const s=localStorage.getItem("authToken");if(localStorage.getItem("userId"),!s){alert("Please log in to manage your wishlist.");return}try{if(!(await fetch("https://shopplus-ecom-backend.onrender.com/wishlist",{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({productId:t})})).ok)throw new Error("Failed to remove item from wishlist.");d.success("Item removed from wishlist successfully!",{position:"top-center",autoClose:2e3}),c(o=>o.filter(h=>h.productId._id!==t))}catch(r){console.error("Error removing from wishlist:",r.message),alert("Error removing item from wishlist.")}};return e.jsxs("div",{className:i.wishlist,children:[e.jsx("h1",{children:"My Wishlist"}),m?e.jsx("div",{className:i.wishlistContainer,children:n.length>0?n.map(t=>e.jsxs("div",{className:i.wishlistItem,children:[e.jsx("img",{src:t.productId.image,alt:t.productId.name}),e.jsxs("div",{children:[e.jsx("h3",{children:t.productId.name}),e.jsxs("p",{children:["Price: $",t.productId.price]}),e.jsx("button",{onClick:()=>w(t.productId._id),children:"Add to Cart"}),e.jsx("button",{className:i.removeButton,onClick:()=>f(t.productId._id),children:"Remove"})]})]},t.productId._id)):e.jsx("p",{children:"Your wishlist is empty."})}):e.jsxs("p",{children:["Please ",e.jsx(j,{to:"/login",children:"log in"})," to view your wishlist."]}),e.jsx(I,{})]})}export{E as default};
